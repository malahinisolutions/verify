<!DOCTYPE html>
<html>
<head>
  <title>
  Verification
  </title>
<meta content='width=device-width, initial-scale=1, maximum-scale=1' name='viewport'>
  <link rel="stylesheet" href="/assets/application-1.css" />
  <link rel="stylesheet" href="/assets/fileinput.min.css" />
  <script type="text/javascript" src="/assets/application.js"></script>
  <script src="/assets/fileinput.js"></script>

</head>
<body class='account-profile-page'>

<div class="account-profile-page">
  <div id='preloader'>
    <div class='with_bg' id='status'></div>
  </div>
  <section class='main-content-area'>
    <%=form_tag({:action=> 'upload_image'}, :multipart=> true) do %>
        <input type="hidden" name="video_id" id="video_id">
        <div class='row margin0'>
          <div class='row-inr'>
            <!-- main content starts here -->
            <div class='main-right-area bg-page'>
              <header>
                <div class='page-title'>

                </div>
                <div class='clr'></div>
              </header>
              <section class='container-fluid main-contaier'>
                <div class="row">
                  <div class="board">
                    <div class="board-inner">
                      <ul class="nav nav-tabs" id="myTab">
                        <div class="liner"></div>
                        <li class="active" id="home_li"> <a href="#home" data-toggle="tab" title="Process">
                          <span class="round-tabs one"> <i class=""><img src="/assets/home.png" class="icon-ver" /></i> </span> </a></li>
                        <li class="disabled" id="details_li">
                          <a href="#settings" data-toggle="tab" title="Details"> <span class="round-tabs four"> <i>   <img src="/assets/details.png" class="icon-ver" />  </i> </span> </a>
                        </li>
                        <li class="disabled" id="photo_li">
                          <a href="#profile" data-toggle="tab" title="Images">
                      <span class="round-tabs two"> <i class="">
                        <img src="/assets/image.png" class="icon-ver" /></i> </span> </a> </li>
                        <li class="disabled" id="video_li">
                          <a href="#messages" data-toggle="tab" title="Video">
                      <span class="round-tabs three"> <i class="">
                        <img src="/assets/video.png" class="icon-ver" /></i> </span> </a>
                        </li>
                      </ul>
                    </div>
                    <div class="tab-content">
                      <div class="tab-pane fade in active" id="home">
                        <div class="logo-img">

                        </div>
                        <p class="tab-detail">
                          Verification System requested that you verify your identity.
                          <br />
                          The process includes a few steps:
                        </p>
                        <table class="tab-pane-table">
                          <tbody>
                          <tr>
                            <td><span class="verification-home">1</span></td>
                            <td>Confirm your name and email address.</td>
                          </tr>
                          <tr>
                            <td><span class="verification-home">2</span></td>
                            <td>Upload a photo of your passport or driver's license.</td>
                          </tr>
                          <tr>
                            <td><span class="verification-home">3</span></td>
                            <td>Record a short video of yourself (selfie) reading a security code.</td>
                          </tr>
                          </tbody>
                        </table>
                        <div class="form-horizontal text-center">
                          <button type="submit" id="home_form" href="#settings" name="home_form" class="btn-submit  btn btn-success-1 btn-outline-rounded green"> Continue </button>
                        </div>
                      </div>
                      <div class="tab-pane fade" id="settings">

                        <div class="alert-message alert-message-warning">
                          <h4>
                            Are these details correct ?
                          </h4>
                          <p>
                            These details MUST MATCH your governmental issued Identification Card or Drivers License or you will FAIL Verification.
                          </p>
                        </div>

                        <div class="well details-panel">

                          <ul class="list-group">
                            <li class="list-group-item">
                              <i>  <img src="/assets/home.png" class="details-icon-img" /> </i>
                              <%=@user[:first_name]%> <%=@user[:last_name]%> </li>
                            <li class="list-group-item">  <i>  <img src="/assets/email.png" class="details-icon-img" /> </i>
                              <%=@user[:email]%></li>
                            <li class="list-group-item">
                              <i>  <img src="/assets/birthdy.png" class="details-icon-img"/> </i> <%=@user[:dob]%>
                            </li>
                            <li class="list-group-item">  <i>  <img src="/assets/address.png" class="details-icon-img" /> </i>
                              <%=@user[:home_address]%>
                            </li>

                          </ul>
                        </div>
                        <div class="form-horizontal text-center">
                          <a href="/control/personal_information" class="btn-submit btn btn-success-1 btn-outline-rounded green">Go Back</a>
                          <button type="button" href="#profile" id="settings_form" name="settings_form" class="btn-submit btn btn-success-1 btn-outline-rounded green">
                              Continue
                            </button>
                          </div>
                      </div>
                      <div class="tab-pane fade" id="profile">
                        <p class="upload-passport">Upload a passport or drivers license </p>
                        <label class="document-type">Document Type:</label>
                        <select class="kv-fileinput-select"  name="document_type">
                          <option value="Driver's License">
                            Driver's License
                          </option>
                          <option value="Passport">
                            Passport
                          </option>
                        </select>
                        <div id="form1">
                          <div class="form-group">
						    <div class="upload-inp" style="padding:10px 0px; padding: 10px 0px;">
                            <input type="file" id="inputFile11" name="upload[datafile]"
                                   onchange="return readURL(this)"  style="position: inherit !important;"/>
                            <input type="submit" id="upload" value="Upload" style="display:none;" />
                            </div>
                            <div class="upload-preview" style="clear:both;">
                              <div class="upload-drop-zone" id="preview_container">
                                <!--div class="upload-drop-zone-title">
                                </div-->
                              </div>

                              <img id="image_upload_preview" style="display:none;">

                            </div>
                          </div>

                        </div>
                        <div class="form-horizontal text-center" >
                          <button type="submit" id="profile_form" href="#messages" name="profile_form" class="btn-submit btn btn-success-1 btn-outline-rounded green"> Continue</button>
                        </div>
                      </div>
                      <div class="tab-pane fade" id="messages">
                        <div class="panel-body">
                          <div id="hdfvr-content" class="video-record" style="clear:both;">
                          </div>

                          <div class="video-detail" style="margin-top:70px !important; clear:both;">
						   <div style=" width: 293px;margin: 0px auto;">
                              <% @number.to_s.each_char do |n| %>
                              <div class="circle">
                                <p>  <%=n%></p>
                              </div>
                              <%end%>
                            </div>
							 <div class="form-horizontal text-center">
                          <button type="submit" href="#settings" id="btnSubmitForm" name="messages_form"
                                  class="btn btn-success-1 btn-outline-rounded green" style="display: none;"> Finish </button>
                        </div>

                            <p >
                              Record a short video of yourself reading aloud the code below in English, digit by digit.
                              <br />
                              Your whole face must be visible. Take off your glasses and hat.
                              <br />
                              Please hold your passport or driving licence at the front of webcam:
                              <br/>
                              If you are showing your passport then please show the address page and the page which has your photo.
                              <br/>
                              If you are showing your driving licence then please show front and backside of the card.

                            </p>

                          </div>

						    <div>
							<p > <h2 style="font-size: 20px;font-weight: bold;text-transform: uppercase;"> Video Recording  Instructions </h2> </p>

                    <div class="step-test">
						<h2> Step 1: </h2>
                        <img src="/assets/img1.jpg" alt="First slide">
                    </div>

                    <div class="step-test">
					<h2> Step 2: </h2>
                        <img src="/assets/img2.jpg" alt="Second slide">
                    </div>

                    <div class="step-test">
					<h2> Step 3: </h2>
                        <img src="/assets/img3.jpg" alt="Third slide">
                    </div>

                     <div class="step-test">
					 <h2> Step 4: </h2>
                        <img src="/assets/img4.jpg" alt="Four slide">

                    </div>
					 <div class="step-test">
					 <h2> Step 5: </h2>
                        <img src="/assets/img5.jpg" alt="Five slide">

                    </div>
 <div class="step-test">
 <h2> Step 6: </h2>
                        <img src="/assets/img6.jpg" alt="Five slide">

                    </div>


                </div>
                        </div>

                      </div>
                      <div class="clearfix"></div>
                    </div>
                  </div>
                </div>
                <div class='clearfix'></div>
              </section>
            </div>
          </div>
        </div>
    <% end %>
    <%=render 'layouts/footer_small'%>
  </section>
  <script type="text/javascript">
    $(function () {
      $('a[title]').tooltip();
      $('.btn-submit').on('click', function (e) {
        var formname = $(this).attr('name');
        var tabname = $(this).attr('href');
        if ($('#' + formname)[0].checkValidity())
        { /* Only works in Firefox/Chrome need polyfill for IE9, Safari. */
          e.preventDefault();
          if("profile_form"==formname && $("#inputFile11").val()=="")
          {
            alert('Please select a image first');
            return false;
          }
          $('#home_li').addClass('disabled');
          $('#photo_li').addClass('disabled');
          $('#video_li').addClass('disabled');
          $('#details_li').addClass('disabled');

          $('ul.nav li a[href="' + tabname + '"]').parent().removeClass('disabled');
          $('ul.nav li a[href="' + tabname + '"]').trigger('click');
        }
      });
      $('ul.nav li').on('click', function (e) {
        if ($(this).hasClass('disabled')) {
          e.preventDefault();
          return false;
        }
      });

    });
  </script>
  <script type="text/javascript">
    function readURL(input) {
      var error=false;
      if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function (e) {
          if(e.target.result.startsWith('data:image'))
          {
            $('#preview_container').hide();
            $('#image_upload_preview').attr('src', e.target.result);
            $('#image_upload_preview').show();
            error=false;
          }
          else
          {
            error=true;
            alert('You can only select image');
          }
        }
        reader.readAsDataURL(input.files[0]);
      }
      return error;
    }
  </script>
  <script type="text/javascript">
    var size = { width: 420, height: 330 };
    var flashvars = {qualityurl: "avq/240p.xml",accountHash:"9ed17e907ed314284bab07ec26bef644",showMenu:"true", mrt:25,sis:0,asv:1,bgCol: "0xababab",payload:"<%=@user[:email]%>"};
    (function() {var pipe = document.createElement('script'); pipe.type = 'text/javascript'; pipe.async = true;pipe.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 's1.addpipe.com/1.3/pipe.js';var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pipe, s);})();
    function onUploadDone(streamName, streamDuration, userId, recorderId, audioCodec, videoCodec, fileType) {
      $('#video_id').val(streamName);
      console.log(streamName);
      console.log('9ed17e907ed314284bab07ec26bef644');
      $("#btnSubmitForm").show();
    }
    function onVideoUploadSuccess(streamName, streamDuration, userId, recorderId, audioCodec, videoCodec, fileType) {
      $('#video_id').val(streamName);
      $("#btnSubmitForm").show();
    }
    function onVideoUploadFailed(error){
      alert("Something wrong!!!, Unable to upload, Please resubmit your video for verification.");
    }
    $( "#btnSubmitForm" ).click(function() {
      $('#saving_container').show();
      //$(this).prop("disabled",true);
    });

  </script>
<!--  onSaveOk(streamName, streamDuration, userId, cameraName, micName, recorderId, audioCodec, videoCodec, fileType, videoId) -->
<div id="saving_container" style="display:none;">
	<div id="saving" style="background-color:rgba(0,0,0,.5); position:fixed; width:100%; height:100%; top:0px; left:0px;z-index:100000"></div>
	<img id="saving_animation" src="/assets/storing_animation.gif" alt="saving" style="z-index:100001; margin-left:-32px; margin-top:-32px; position:fixed; left:50%; top:50%"/>
</div>

	<style>

	.upload-drop-zone {
    text-align: center;
    vertical-align: middle;
    margin: 2px 2px 2px 2px !important;}
	.carousel-control{top: 47% !important;width: 10% !important;}
	.carousel-control.left{    background-image: -webkit-linear-gradient(left, rgba(0,0,0,0) 0, rgba(0,0,0,0) 100%) !importants;
	    background-image: linear-gradient(to right, rgba(0,0,0,0) 0, rgba(0,0,0,0) 100%) !important;}
	.carousel-control.right{background-image:none !important;}
	.carousel-caption{.carousel-caption {
    position: absolute;
    right: 0px !importants;
    bottom: 0px !important; padding-bottom:0px !important;}
	.upload-inp input{float:right !important;min-width: 100px !important; width: 188px !important; max-width: 400px !important;}


	</style>

</div>
</body>
</html>
